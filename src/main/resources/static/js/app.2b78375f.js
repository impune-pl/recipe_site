(function(e){function t(t){for(var s,a,o=t[0],c=t[1],l=t[2],d=0,p=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&p.push(r[a][0]),r[a]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);u&&u(t);while(p.length)p.shift()();return n.push.apply(n,l||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],s=!0,o=1;o<i.length;o++){var c=i[o];0!==r[c]&&(s=!1)}s&&(n.splice(t--,1),e=a(a.s=i[0]))}return e}var s={},r={app:0},n=[];function a(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=s,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(i,s,function(t){return e[t]}.bind(null,s));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;n.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"0b7a":function(e,t,i){"use strict";var s=i("da8a"),r=i.n(s);r.a},"56d7":function(e,t,i){"use strict";i.r(t);i("45fc"),i("d3b7"),i("4d63"),i("ac1f"),i("25f0"),i("466d"),i("e260"),i("e6cf"),i("cca6"),i("a79d");var s=i("bc3a"),r=i.n(s),n=i("2b0e"),a=i("8c4f"),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-navbar",{staticClass:"shadow-sm justify-content-between",attrs:{type:"light"}},[i("b-navbar-brand",{attrs:{to:{name:"index"}}},[e._v(" Recipe site ")]),i("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),i("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[i("b-navbar-nav",{staticClass:"justify-content-end"},[e.isLoggedIn&&e.userType?i("b-nav-item",{attrs:{to:{name:"admin"}}},[e._v("Admin")]):e._e(),e.isLoggedIn?i("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[e._v(" Hi, "+e._s(e.name)+" ")]},proxy:!0}],null,!1,2910111336)},[i("b-dropdown-item",{on:{click:function(t){return e.logout()}}},[e._v("Sign Out")])],1):e._e(),e.isLoggedIn?e._e():i("b-nav-item",{attrs:{to:{name:"login"},right:""}},[e._v("Log In")]),e.isLoggedIn?e._e():i("b-nav-item",{attrs:{to:{name:"register"},right:""}},[e._v("Register")])],1)],1)],1),i("main",{staticClass:"py-4"},[i("router-view",{on:{loggedin:e.change}})],1)],1)},c=[],l=(i("caad"),i("b0c0"),i("2532"),{name:"App",data:function(){return{name:"",userType:0,isLoggedIn:null!=localStorage.getItem("recipe-site.jwt")}},mounted:function(){this.setDefaults()},methods:{setDefaults:function(){if(this.isLoggedIn){var e=JSON.parse(localStorage.getItem("recipe-site.user"));this.name=e.name,this.userType=e.roles.includes("ADMIN")}},change:function(){this.isLoggedIn=null!=localStorage.getItem("recipe-site.jwt"),this.setDefaults()},logout:function(){localStorage.removeItem("recipe-site.jwt"),localStorage.removeItem("recipe-site.user"),this.change(),this.$router.push("/")}}}),u=l,d=i("2877"),p=Object(d["a"])(u,o,c,!1,null,"367d12c3",null),m=p.exports,f=i("5f5b"),h=i("b1e0"),b=(i("f9e3"),i("2dd8"),i("ecee")),g=i("ad3d"),w=i("c074"),v=function(){var e=this,t=this,i=t.$createElement,s=t._self._c||i;return s("b-container",[s("b-list-group",{attrs:{horizontal:""}},[s("b-list-group-item",[s("b-form",{attrs:{inline:""}},[s("b-form-input",{attrs:{type:"text"},model:{value:this.filterType,callback:function(e){t.$set(this,"filterType",e)},expression:"this.filterType"}})],1)],1),s("b-list-group-item",[s("b-form",{attrs:{inline:""}},[s("b-form-input",{attrs:{type:"text"},model:{value:this.filterAuthorName,callback:function(e){t.$set(this,"filterAuthorName",e)},expression:"this.filterAuthorName"}})],1)],1),s("b-list-group-item",[s("b-form",{attrs:{inline:""}},[s("b-form-input",{attrs:{type:"number"},model:{value:this.filterRating,callback:function(e){t.$set(this,"filterRating",e)},expression:"this.filterRating"}})],1)],1),s("b-list-group-item",[s("b-form",{attrs:{inline:""}},[s("b-button",{attrs:{variant:"primary"},on:{click:function(e){return this.resetFilters()}}},[t._v("Reset")]),s("b-button",{attrs:{variant:"primary"},on:{click:function(e){return this.filterRecipes()}}},[t._v("Filter")])],1)],1)],1),s("b-card-group",{attrs:{deck:""}},[this.isLoggedIn?s("b-card",{staticClass:"shadow-sm mb-5 rounded-0 border-0 col-md-3",staticStyle:{"min-width":"18rem","max-width":"319px"},attrs:{"img-top":""}},[s("b-card-body",[s("b-form-rating",{attrs:{"show-value":"","show-value-max":"",precision:"1","no-border":"",readonly:""}}),s("b-button",{staticClass:"text-decoration-none",attrs:{variant:"link"},on:{click:function(e){return this.showModal()}}},[s("p",[t._v(" Add new recipe ")])])],1)],1):t._e(),t._l(t.recipes,(function(e){return s("b-card",{key:e.uuid,staticClass:"shadow-sm mb-5 rounded-0 border-0 col-md-3",staticStyle:{"min-width":"18rem","max-width":"319px"},attrs:{"img-top":"","img-src":e.imageName}},[s("b-card-body",[s("b-form-rating",{attrs:{"v-model":e.difficultyRating,"show-value":"","show-value-max":"",precision:"1","no-border":"",readonly:""}}),s("b-button",{staticClass:"text-decoration-none",attrs:{variant:"link",to:{name:"recipe-details",params:{id:e.uuid}}}},[s("p",[t._v(" "+t._s(e.title)+" ")])])],1)],1)}))],2),s("b-modal",{attrs:{id:"addNewRecipeModal"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("b-row",[s("b-form",[s("b-form-group",{attrs:{label:"Title"}},[s("b-form-text",{attrs:{name:"title"},model:{value:this.newRecipe.title,callback:function(e){t.$set(this.newRecipe,"title",e)},expression:"this.newRecipe.title"}})],1),s("b-form-group",{attrs:{label:"Content"}},[s("b-form-textarea",{attrs:{name:"content"},model:{value:this.newRecipe.content,callback:function(e){t.$set(this.newRecipe,"content",e)},expression:"this.newRecipe.content"}})],1),s("b-form-group",{attrs:{label:"Type"}},[s("b-form-text",{attrs:{name:"type"},model:{value:this.newRecipe["type"],callback:function(e){t.$set(this.newRecipe,"type",e)},expression:"this.newRecipe['type']"}})],1),s("b-form-group",{attrs:{label:"Difficulty rating"}},[s("b-form-rating",{attrs:{name:"difficultyRating","show-value":"","show-value-max":"",precision:"1","no-border":""},model:{value:this.newRecipe.content,callback:function(e){t.$set(this.newRecipe,"content",e)},expression:"this.newRecipe.content"}})],1),s("b-form-group",{attrs:{label:"Photo"}},[s("b-form-file",{attrs:{type:"file",id:"image",name:"image"},on:{input:function(t){return e.uploadFile(t)}}})],1),s("b-form-group",{attrs:{label:"Ingredients"}},[s("b-list-group",t._l(this.newRecipe.ingredients,(function(e){return s("b-list-group-item",{key:e},[t._v(t._s(e))])})),1),s("b-form-text",{model:{value:t.ingredient,callback:function(e){t.ingredient=e},expression:"ingredient"}}),s("b-button",{attrs:{variant:"link"},on:{click:function(e){return this.addIngredient()}}},[s("font-awesome-icon",{attrs:{icon:["fas","plus"]}})],1)],1),s("b-button",{attrs:{variant:"primary"},on:{click:function(e){return this.addNewRecipe()}}},[t._v("Save")])],1)],1)],1)],1)},y=[],x={name:"Index",data:function(){return{recipes:[],isLoggedIn:!1,isAdmin:!1,newRecipe:{title:"",content:"",ingredients:[],type:"",difficultyRating:0,imageName:""},ingredient:"",show:!1,filterType:"",filterAuthorName:"",filterRating:null}},beforeMount:function(){this.loadRecipes();var e=JSON.parse(localStorage.getItem("recipe-site.user"));e?(this.isLoggedIn=!0,e.roles.includes("ADMIN")&&(this.isAdmin=!0)):this.isLoggedIn=!1},methods:{resetFilters:function(){this.filterType="",this.filterAuthorName="",this.filterRating=null},filterRecipes:function(){var e=this,t="";this.filterType&&(t+="type="+this.filterType),this.filterAuthorName&&(t+="authorName="+this.filterAuthorName),null!==this.filterRating&&(t+="rating="+this.filterRating),window.axios.get("api/recipe?"+t).then((function(t){e.recipes=t.data})).catch((function(){return console.log("error loading recipe data")}))},loadRecipes:function(){var e=this;window.axios.get("api/recipe").then((function(t){e.recipes=t.data})).catch((function(){return console.log("error loading recipe data")}))},uploadFile:function(e){var t=this,i=new FormData;i.append("image",e);var s={"Content-Type":"multipart/form-data"};window.axios.post("/api/image/",i,{headers:s}).then((function(e){t.newRecipe.imageName=e.data}))},addIngredient:function(){this.newRecipe.ingredients.push(this.ingredient),this.ingredient=""},showModal:function(){this.show=!0},addNewRecipe:function(){window.axios.post("/api/recipe/",this.newRecipe),this.loadRecipes(),this.show=!1}}},_=x,R=Object(d["a"])(_,v,y,!1,null,"685a68a8",null),k=R.exports,$=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-container",[i("b-card",[i("b-card-img",{staticClass:"border-0 rounded-0 shadow-sm",attrs:{src:"/image/"+e.recipe.imageName,"img-top":""}},[i("b-card-title",[e._v(e._s(e.recipe.title))]),i("b-card-body",[i("b-list-group",e._l(e.recipe.ingredients,(function(t){return i("b-list-group-item",{key:t},[e._v(" "+e._s(t)+" ")])})),1),i("b-card-text",[e._v(" "+e._s(e.recipe.content)+" ")]),this.isAdmin?i("b-button",{staticClass:"text-danger-on-hover",attrs:{variant:"link"},on:{click:function(t){return e.removeRecipe()}}},[i("font-awesome-icon",{attrs:{icon:["fas","trash"]}})],1):e._e(),i("b-card-footer",[e._l(e.comments,(function(t){return i("b-list-group-item",{key:t.uuid},[i("h6",[e._v(e._s(t.authorUsername))]),i("p",[e._v(e._s(t.text))]),this.isAdmin?i("b-button",{staticClass:"text-danger-on-hover",attrs:{variant:"link"},on:{click:function(i){return e.removeComment(t.uuid)}}},[i("font-awesome-icon",{attrs:{icon:["fas","trash"]}})],1):e._e()],1)})),this.isLoggedIn?i("b-form",[i("b-form-group",{attrs:{label:"New comment: "}},[i("b-input",{attrs:{id:"commenttext",type:"textarea",rows:"3","no-resize":"",state:e.text.length>=0&&e.text.length<=500},model:{value:this.text,callback:function(t){e.$set(this,"text",t)},expression:"this.text"}})],1),i("b-form-group",[i("b-button",{attrs:{type:"primary"},on:{click:function(e){return this.addComment()}}},[e._v("Send")])],1)],1):e._e()],2)],1)],1)],1)],1)},L=[],I={name:"Details",data:function(){return{recipe:null,id:null,comments:[],isLoggedIn:!1,isAdmin:!1,text:""}},beforeMount:function(){this.loadRecipe(),this.loadComments();var e=JSON.parse(localStorage.getItem("recipe-site.user"));e?(this.isLoggedIn=!0,e.roles.includes("ADMIN")&&(this.isAdmin=!0)):this.isLoggedIn=!1},methods:{addComment:function(){var e=this;window.axios.post("api/recipe/"+this.id+"/comment",{text:this.text}).then((function(t){e.recipe=t.data})).catch((function(){return console.log("error loading recipe data")}))},removeComment:function(e){window.axios.delete("api/recipe/"+this.id+"/comment/"+e).catch((function(){return console.log("error deleting comment")}))},removeRecipe:function(){var e=this;window.axios.delete("api/recipe/"+this.id).then((function(){e.$router.push({name:"index"})})).catch((function(){return console.log("error deleting recipe")}))},loadRecipe:function(){var e=this;this.id=this.$route.params.id,window.axios.get("api/recipe/"+this.id).then((function(t){e.recipe=t.data})).catch((function(){return console.log("error loading recipe data")}))},loadComments:function(){var e=this;window.axios.get("api/recipe/"+this.id+"/comments").then((function(t){e.comments=t.data})).catch((function(){return console.log("error loading recipe comments")}))}}},S=I,C=(i("0b7a"),Object(d["a"])(S,$,L,!1,null,"429e9ae6",null)),j=C.exports,N=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-container",[i("b-row",[i("b-col",[i("b-card",{staticClass:"rounded-0 border-0 shadow-sm",attrs:{header:"Login"}},[i("b-card-body",[i("b-row",{staticClass:"justify-content-center"},[i("b-form",{staticStyle:{"min-width":"30rem"},on:{submit:function(e){e.stopPropagation(),e.preventDefault()}}},[i("b-form-group",{attrs:{label:"Email Address"}},[i("b-form-input",{ref:"username",attrs:{id:"username",type:"username",required:"",autofocus:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),i("b-form-group",{attrs:{label:"Password"}},[i("b-form-input",{ref:"password",staticClass:"form-control",attrs:{id:"password",type:"password",required:""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),i("b-form-row",{staticClass:"justify-content-end"},[i("b-button",{staticClass:"btn-primary",attrs:{type:"submit"},on:{click:function(t){return e.handleSubmit(t)}}},[e._v(" Login ")])],1)],1)],1)],1)],1)],1)],1)],1)},P=[],A={name:"Login",data:function(){return{username:"",password:""}},methods:{handleSubmit:function(e){var t=this;if(e.preventDefault(),this.password.length>0&&this.email.username>0){var i=this.username,s=this.password;window.axios.post("api/login",{username:i,password:s}).then((function(e){var i=e.data.user,s=i.roles.includes("ADMIN");localStorage.setItem("recipe-site.user",JSON.stringify(i)),localStorage.setItem("recipe-site.jwt",e.data.token),null!=localStorage.getItem("recipe-site.jwt")&&(t.$emit("loggedin"),null!=t.$route.params.nextUrl?t.$router.push(t.$route.params.nextUrl):t.$router.push(!0===s?{name:"admin"}:{name:"index"}))}))}}}},O=A,T=Object(d["a"])(O,N,P,!1,null,"24af71d0",null),M=T.exports,D=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-container",[i("b-row",[i("b-col",[i("b-card",{staticClass:"rounded-0 border-0 shadow-sm",attrs:{header:"Register"}},[i("b-card-body",[i("b-row",{staticClass:"justify-content-center"},[i("b-form",{staticStyle:{"min-width":"30rem"},on:{submit:function(e){e.stopPropagation(),e.preventDefault()}}},[i("b-form-group",{attrs:{label:"Username"}},[i("b-form-input",{ref:"username",attrs:{id:"username",type:"username",required:"",autofocus:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),i("b-form-group",{attrs:{label:"Password"}},[i("b-form-input",{ref:"password",staticClass:"form-control",attrs:{id:"password",type:"password",required:""},on:{change:e.passwordChange},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),i("b-form-group",{attrs:{label:"Repeat password"}},[i("b-form-input",{ref:"repeatPassword",staticClass:"form-control",attrs:{id:"repeatPassword",type:"password",required:""},on:{change:e.passwordChange},model:{value:e.repeatPassword,callback:function(t){e.repeatPassword=t},expression:"repeatPassword"}})],1),i("b-form-row",{staticClass:"justify-content-end"},[i("b-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit(t)}}},[e._v(" Register ")])],1)],1)],1)],1)],1)],1)],1)],1)},E=[],q={name:"Register",data:function(){return{username:"",password:"",repeatPassword:""}},methods:{handleSubmit:function(){var e=this;if(this.password!==this.repeatPassword||this.password.length<=0)return alert("Passwords do not match");var t=this.username,i=this.password,s=this.repeatPassword;window.axios.post("api/register",{username:t,password:i,repeatPassword:s}).then((function(){e.$router.push({name:"login"})}))},passwordChange:function(){this.password!==this.repeatPassword&&this.password.length>=0?(this.$refs["password"].classList.contains("is-valid")&&(this.$refs["password"].classList.remove("is-valid"),this.$refs["password-confirm"].classList.remove("is-valid")),this.$refs["password"].classList.contains("is-invalid")||(this.$refs["password"].classList.add("is-invalid"),this.$refs["password-confirm"].classList.add("is-invalid"))):this.password===this.repeatPassword&&this.password.length>=8?(this.$refs["password"].classList.contains("is-valid")||(this.$refs["password"].classList.add("is-valid"),this.$refs["password-confirm"].classList.add("is-valid")),this.$refs["password"].classList.contains("is-invalid")&&(this.$refs["password"].classList.remove("is-invalid"),this.$refs["password-confirm"].classList.remove("is-invalid"))):(this.$refs["password"].classList.contains("is-valid")&&(this.$refs["password"].classList.remove("is-valid"),this.$refs["password_confirmation"].classList.remove("is-valid")),this.$refs["password"].classList.contains("is-invalid")&&(this.$refs["password"].classList.remove("is-invalid"),this.$refs["password_confirmation"].classList.remove("is-invalid")))}}},F=q,J=Object(d["a"])(F,D,E,!1,null,"3a7eb768",null),U=J.exports;window.axios=r.a,window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",b["c"].add(w["c"],w["b"],w["a"]),n["default"].component("font-awesome-icon",g["a"]),n["default"].config.productionTip=!1,n["default"].use(a["a"]),n["default"].use(f["a"]),n["default"].use(h["a"]);var X=[{path:"/",alias:"/index",name:"index",component:k},{path:"/login",name:"login",component:M},{path:"/recipe/:id",name:"recipe-details",component:j},{path:"/register",name:"register",component:U}],z=new a["a"]({mode:"history",routes:X});r.a.interceptors.request.use((function(e){var t=localStorage.getItem("recipe-site.jwt");if(t){e.headers["Authorization"]="Bearer "+t;var i=document.cookie.match(new RegExp("XSRF-TOKEN=([^;]+)"))[1];e.headers["X-XSRF-TOKEN"]=i}return e}),(function(e){return Promise.reject(e)})),z.beforeEach((function(e,t,i){if(e.matched.some((function(e){return e.meta.requiresAuth})))if(null==localStorage.getItem("recipe-site.jwt"))i({path:"/login",params:{nextUrl:e.fullPath}});else{var s=JSON.parse(localStorage.getItem("recipe-site.user"));e.matched.some((function(e){return e.meta.is_admin}))&&(!0===s.isAdmin?i():i({name:"index"})),i()}else i()})),new n["default"]({router:z,render:function(e){return e(m)}}).$mount("#app")},da8a:function(e,t,i){}});
//# sourceMappingURL=app.2b78375f.js.map